(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{179:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return b})),a.d(t,"metadata",(function(){return l})),a.d(t,"rightToc",(function(){return o})),a.d(t,"default",(function(){return p}));var n=a(1),r=a(9),c=(a(0),a(233)),b={},l={id:"1072/Week10",title:"Week10",description:"# Week 10(2019/04/25) - \u865b\u64ec\u5316\u6280\u8853 Docker",source:"@site/docs/1072/Week10.md",permalink:"/docs/1072/Week10",editUrl:"https://github.com/NCNU-OpenSource/NCNU-OpenSource.github.io/edit/src/docs/1072/Week10.md",sidebar:"someSidebar",previous:{title:"Week9",permalink:"/docs/1072/Week9"},next:{title:"Week11",permalink:"/docs/1072/Week11"}},o=[{value:"\u9069\u5408Docker",id:"\u9069\u5408docker",children:[]},{value:"Docker Engine",id:"docker-engine",children:[{value:"Docker Hub(Repository)",id:"docker-hubrepository",children:[]},{value:"Hello world to download image",id:"hello-world-to-download-image",children:[]}]},{value:"Image Commands",id:"image-commands",children:[]},{value:"Container Commands",id:"container-commands",children:[{value:"Docker volume",id:"docker-volume",children:[]},{value:"Docker Export & Import",id:"docker-export--import",children:[]},{value:"Docker Swarm",id:"docker-swarm",children:[]}]}],i={rightToc:o};function p(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(c.b)("wrapper",Object(n.a)({},i,a,{components:t,mdxType:"MDXLayout"}),Object(c.b)("h1",{id:"week-1020190425---\u865b\u64ec\u5316\u6280\u8853-docker"},"Week 10(2019/04/25) - \u865b\u64ec\u5316\u6280\u8853 Docker"),Object(c.b)("p",null,Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.google.com/presentation/d/1wYhJkBQkx0jS-oyJG-2imdI7p93wti4XZqR9Jc49PxE/edit?usp=sharing"}),"\u672c\u6b21\u5206\u4eab Slide")),Object(c.b)("p",null,Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.docker.com/install/linux/docker-ce/ubuntu/"}),"\u5b89\u88ddDocker")),Object(c.b)("p",null,Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://labs.play-with-docker.com"}),"Play with Docker")),Object(c.b)("p",null,Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://training.play-with-docker.com"}),"Play with Docker \u8ab2\u7a0b")),Object(c.b)("p",null,"\u6aa2\u67e5Docker Version\n",Object(c.b)("inlineCode",{parentName:"p"},"docker -v")," or ",Object(c.b)("inlineCode",{parentName:"p"},"docker version")),Object(c.b)("h1",{id:"vm-\u8207-docker-\u5716\u89e3"},"VM \u8207 Docker \u5716\u89e3"),Object(c.b)("p",null,Object(c.b)("img",Object(n.a)({parentName:"p"},{src:"https://i.imgur.com/4yDSaul.jpg",alt:null}))),Object(c.b)("blockquote",null,Object(c.b)("h6",Object(n.a)({parentName:"blockquote"},{id:"source--\u963f\u820d\u7684\u96a8\u624b\u8a18\u8a18"}),"source : ",Object(c.b)("a",Object(n.a)({parentName:"h6"},{href:"https://www.arthurtoday.com/2014/12/docker-vs-lxc-container.html"}),"\u963f\u820d\u7684\u96a8\u624b\u8a18\u8a18"))),Object(c.b)("h2",{id:"\u9069\u5408docker"},"\u9069\u5408Docker"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"\u6c92\u958b\u653e\u4f7f\u7528\u8005\u767b\u9304",Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},"(ssh)\u5371\u96aa(\u8b93\u7121\u95dc\u7b2c\u4e09\u8005\u770b\u5230 docker container \u8cc7\u6599)"),Object(c.b)("li",{parentName:"ul"},"\u4e0d\u65b9\u4fbf"))),Object(c.b)("li",{parentName:"ul"},"\u53ea\u63d0\u4f9b\u7db2\u9801\u670d\u52d9\u7b49\u6bd4\u8f03\u55ae\u7d14\u7684 Service"),Object(c.b)("li",{parentName:"ul"},"\u26a0\ufe0f\u9700\u8981\u5927\u91cf\u6a94\u6848\u786c\u789f\u8b80\u5beb\uff08\u5efa\u8b70mount\u5176\u4ed6\u786c\u789f\uff09")),Object(c.b)("h2",{id:"docker-engine"},"Docker Engine"),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"\u91dd\u5c0d\u6240\u6709\u5bb9\u5668\u505a\u7d71\u4e00\u7ba1\u7406"),Object(c.b)("ul",{parentName:"blockquote"},Object(c.b)("li",{parentName:"ul"},"\u6620\u50cf\u6a94(Image)",Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},"\u8a2d\u5b9a\u6a94"))),Object(c.b)("li",{parentName:"ul"},"\u5bb9\u5668(Container)",Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},"Image run \u8d77\u4f86\u7684\u74b0\u5883"))),Object(c.b)("li",{parentName:"ul"},"\u5009\u5eab(Repository)",Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},"\u653eimage\u7684\u5730\u65b9\uff08\u4e0d\u540c\u7248\u672c\uff09"),Object(c.b)("li",{parentName:"ul"},"\u4f7f\u7528\u8005\u4e0a\u50b3image"))),Object(c.b)("li",{parentName:"ul"},"\u8a3b\u518a\u8868(Registry)\n+ \u5728\u5b98\u65b9\u4e0b\u8f09"))),Object(c.b)("h3",{id:"docker-hubrepository"},"Docker Hub(Repository)"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Docker \u4f7f\u7528\u65b9\u6cd5\u6709\u5169\u7a2e")),Object(c.b)("ol",null,Object(c.b)("li",{parentName:"ol"},"\u91cd\u982d\u81ea\u5df1\u88dd"),Object(c.b)("li",{parentName:"ol"},"\u53bb ",Object(c.b)("a",Object(n.a)({parentName:"li"},{href:"https://hub.docker.com/"}),"Docker Hub")," \u627e\u5225\u4eba\u505a\u597d\u7684 image"),Object(c.b)("li",{parentName:"ol"},"\u6709official image",Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},"\u6bd4\u8f03\u5b89\u5168"))),Object(c.b)("li",{parentName:"ol"},"\u9084\u6709\u770b\u4f7f\u7528\u3001\u9ede\u64ca\u6578\u91cf\u7b49\u7684image")),Object(c.b)("h3",{id:"hello-world-to-download-image"},"Hello world to download image"),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"\u672c\u5730\u6c92\u6709\u7684\u8a71\u5c31\u6703\u53bb Docker hub \u627e & \u81ea\u52d5\u4e0b\u8f09")),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell="}),"sudo docker run hello-world\n")),Object(c.b)("h2",{id:"image-commands"},"Image Commands"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("h3",Object(n.a)({parentName:"li"},{id:"list-image\u67e5\u770b\u672c\u5730\u6240\u6709"}),"List image(\u67e5\u770b\u672c\u5730\u6240\u6709)"),Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(n.a)({parentName:"pre"},{}),"docker image ls\ndocker images\n"))))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("h3",Object(n.a)({parentName:"li"},{id:"pull-image"}),"Pull image"),Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(n.a)({parentName:"pre"},{}),"docker pull {image name}:{tag}\n\n{tag}: \u7248\u672c\u865f \u4e5f\u53ef\u4ee5\u76f4\u63a5 latest\n\n## ex. docker pull ubuntu:16.04\n"))))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("h3",Object(n.a)({parentName:"li"},{id:"run-image"}),"Run image"),Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},Object(c.b)("inlineCode",{parentName:"p"},"-i")," \u5f9e STDIN \u8f38\u5165")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},Object(c.b)("inlineCode",{parentName:"p"},"-t")," \u958b\u65b0\u7684 TTY (terminal)")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},Object(c.b)("inlineCode",{parentName:"p"},"--name")," \u8a2d\u5b9ainstance\u7684\u540d\u7a31 (\u65b9\u4fbf\u7ba1\u7406)")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},Object(c.b)("inlineCode",{parentName:"p"},"--rm")," \u7a0b\u5f0f\u7d50\u675f\u5f8c\u81ea\u52d5\u6e05\u9664container"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(n.a)({parentName:"pre"},{}),"docker run ...\n\n## ex. docker run -t -i ubuntu:16.04 /bin/bash\n")),Object(c.b)("p",{parentName:"li"},"Run Image \u5f8c\u6703\u7522\u751f\u8a72 container")))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("h3",Object(n.a)({parentName:"li"},{id:"remove-none-image"}),"Remove None image"),Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},Object(c.b)("inlineCode",{parentName:"li"},"docker image prune")))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("h3",Object(n.a)({parentName:"li"},{id:"commit-image"}),"Commit Image"),Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},"Tag\u662f\u552f\u4e00\uff0cName\u53ef\u91cd\u8907\uff0c\u82e5\u5169\u8005\u76f8\u540c\uff0c",Object(c.b)("inlineCode",{parentName:"li"},"oldest"),"\u6703\u88ab ",Object(c.b)("inlineCode",{parentName:"li"},"<None>")," \u53d6\u4ee3")))),Object(c.b)("h2",{id:"container-commands"},"Container Commands"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("h3",Object(n.a)({parentName:"li"},{id:"check-\u67e5\u770b"}),"Check \u67e5\u770b"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(n.a)({parentName:"pre"},{}),"docker ps # \u53ea\u80fd\u67e5\u770b running\n# -a \u624d\u80fd\u770b\u5230\u6c92\u6709\u5728\u57f7\u884c\u7684 container\n# -q \u53ea\u986f\u793a container id\ndocker ps [-a] [-q]\n"))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("h3",Object(n.a)({parentName:"li"},{id:"stop-container\u4ecd\u53efrun"}),"Stop container(\u4ecd\u53efrun)"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(n.a)({parentName:"pre"},{}),"docker container stop {CONTAINER ID | NAME}\n")),Object(c.b)("p",{parentName:"li"},"  \u6279\u6b21\uff1a",Object(c.b)("inlineCode",{parentName:"p"},"docker stop $(docker container ls -a -q)"))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("h3",Object(n.a)({parentName:"li"},{id:"remove-container\u5df2\u4e0d\u5b58\u5728"}),"Remove container(\u5df2\u4e0d\u5b58\u5728)"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(n.a)({parentName:"pre"},{}),"docker container rm {CONTAINER ID | NAME}\n")),Object(c.b)("p",{parentName:"li"},"  \u6279\u6b21\uff1a",Object(c.b)("inlineCode",{parentName:"p"},"docker container rm $(docker container ls -a -q)"),"\n\u5168\u90e8\uff1a",Object(c.b)("inlineCode",{parentName:"p"},"docker container prune"))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("h3",Object(n.a)({parentName:"li"},{id:"\u6700\u5c0f\u7684os"}),"\u6700\u5c0f\u7684OS"),Object(c.b)("blockquote",{parentName:"li"},Object(c.b)("p",{parentName:"blockquote"},"[name=\u7dad\u57fa\u767e\u79d1]"),Object(c.b)("h6",Object(n.a)({parentName:"blockquote"},{id:"alpine-linux\u662f\u4e00\u500b\u7531\u793e\u7fa4\u958b\u767c\u7684linux\u4f5c\u696d\u7cfb\u7d71\uff0c\u8a72\u4f5c\u696d\u7cfb\u7d71\u4ee5\u5b89\u5168\u70ba\u7406\u5ff5\uff0c\u9762\u5411x86\u8def\u7531\u5668\u3001\u9632\u706b\u7246\u3001\u865b\u64ec\u79c1\u4eba\u7db2\u8def\u3001ip\u96fb\u8a71\u76d2\u53ca\u4f3a\u670d\u5668\u800c\u8a2d\u8a08\u3002"}),"Alpine Linux\u662f\u4e00\u500b\u7531\u793e\u7fa4\u958b\u767c\u7684Linux\u4f5c\u696d\u7cfb\u7d71\uff0c\u8a72\u4f5c\u696d\u7cfb\u7d71\u4ee5\u5b89\u5168\u70ba\u7406\u5ff5\uff0c\u9762\u5411x86\u8def\u7531\u5668\u3001\u9632\u706b\u7246\u3001\u865b\u64ec\u79c1\u4eba\u7db2\u8def\u3001IP\u96fb\u8a71\u76d2\u53ca\u4f3a\u670d\u5668\u800c\u8a2d\u8a08\u3002"),Object(c.b)("pre",{parentName:"blockquote"},Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"docker pull alpine\n"))))),Object(c.b)("h4",{id:"docker-\u751f\u547d\u9031\u671f"},"Docker \u751f\u547d\u9031\u671f"),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"\u76ee\u7684\u57f7\u884c\u67d0\u500b\u7a0b\u5f0f Ex. Nginx / Apache\n\u537b\u60f3\u8981\u628a\u5b83\u5c01\u8d77\u4f86\u88dd\u5728\u67d0\u500b\u5b89\u5168\u7684\u5340\u57df\nThat's container ","[color=teal]")),Object(c.b)("p",null,"image -> run process -> \u7d50\u675f -> container terminate (\u505c\u6b62)"),Object(c.b)("p",null,"\u7279\u6b8a\u61c9\u7528: \u8dd1\u9032\u67d0\u500b container \u505a\u4e8b\u60c5, \u57f7\u884c Shell(bash)"),Object(c.b)("h3",{id:"docker-volume"},"Docker volume"),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"\u7528\u4f86\u4fdd\u5b58\u5bb9\u5668\u5167\u8cc7\u6599(\u9577\u671f\u5132\u5b58)\n\u751f\u547d\u9031\u671f\u7d50\u675f\u4e4b\u5f8c\u9084\u6703\u6d3b\u8457")),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell="}),"# \u5efa\u7acb Docker volume\ndocker volume create --name <volume>\n# \u67e5\u770b Docker volume\ndocker volume ls\n# \u639b\u8f09 volume\ndocker run -v {volume}:{path} {image}\n")),Object(c.b)("h3",{id:"docker-export--import"},"Docker Export & Import"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Export",Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},Object(c.b)("inlineCode",{parentName:"li"},"docker export {Container ID} > {file name}")))),Object(c.b)("li",{parentName:"ul"},"Import",Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},Object(c.b)("inlineCode",{parentName:"li"},"docker import {file name} - {image name}:{tag}")))),Object(c.b)("li",{parentName:"ul"},"Export and import practice:",Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"")))))),Object(c.b)("p",null,":::info\nDocker using AUFS - layer file system"),Object(c.b)("p",null,"Layer \u53ef\u4ee5 cache\nEX: \u88dd nginx \u76f4\u63a5\u628a\u8a72 layer cache \u6293\u9032\u4f86, \u6709\u9700\u8981\u66f4\u6539\u7684\u518d\u53bb\u6539\n:::"),Object(c.b)("h3",{id:"docker-swarm"},"Docker Swarm"),Object(c.b)("p",null,"\u628a\u591a\u500b images \u7d44\u6210\u985e\u4f3c\u7fa4\u7d44\u7684\u5b58\u5728\uff0c\u7528\u4f86\u5206\u6563\u5de5\u4f5c\u8ca0\u64d4\uff0c\u53ef\u4ee5\u4f86\u505a\u8ca0\u8f09\u5e73\u8861\u3001\u670d\u52d9\u4e0d\u4e2d\u65b7\u7684\u670d\u52d9\u3002"),Object(c.b)("p",null,"Container \u7684\u8cc7\u6599\u5916\u90e8\u5132\u5b58(Volume)\uff0c\u4e0d\u4f9d\u8cf4\u5167\u90e8\u5132\u5b58"),Object(c.b)("p",null,":::info\n\u5716\u5f62\u5316\u670d\u52d9"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell="}),"docker service create --name=viz --publish=8080:8080/tcp --constraint=node.role==manager --mount=type=bind,src=/var/run/docker.sock,dst=/var/run/docker.sock dockersamples/visualizer\n")),Object(c.b)("p",null,"\u5229\u7528 Telent \u9023\u7dda\u81f3 ",Object(c.b)("inlineCode",{parentName:"p"},"/var/run/docker.sock")," \u4e5f\u53ef\u4ee5\u770b\u5230\n:::"))}p.isMDXComponent=!0},233:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return j}));var n=a(0),r=a.n(n);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=r.a.createContext({}),p=function(e){var t=r.a.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):l({},t,{},e)),a},m=function(e){var t=p(e.components);return r.a.createElement(i.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},O=Object(n.forwardRef)((function(e,t){var a=e.components,n=e.mdxType,c=e.originalType,b=e.parentName,i=o(e,["components","mdxType","originalType","parentName"]),m=p(a),O=n,j=m["".concat(b,".").concat(O)]||m[O]||u[O]||c;return a?r.a.createElement(j,l({ref:t},i,{components:a})):r.a.createElement(j,l({ref:t},i))}));function j(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var c=a.length,b=new Array(c);b[0]=O;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:n,b[1]=l;for(var i=2;i<c;i++)b[i]=a[i];return r.a.createElement.apply(null,b)}return r.a.createElement.apply(null,a)}O.displayName="MDXCreateElement"}}]);